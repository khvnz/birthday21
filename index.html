<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>You Day</title>

<style>
  :root{
    --bg1:#ffe8ee;
    --bg2:#eafff4;
    --bg3:#f2ecff;
    --card: rgba(255,255,255,.86);
    --ink:#1f1f1f;
    --muted:#6a6a6a;
    --pink:#ffb3c7;
    --peach:#ffd2a6;
    --mint:#bfead8;
    --lav:#d8c7ff;
    --shadow: 0 18px 45px rgba(0,0,0,.12);
    --radius: 24px;
  }

  *{ box-sizing:border-box; }
  body{
    margin:0;
    min-height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    color:var(--ink);
    background:
      radial-gradient(circle at 15% 10%, var(--bg1) 0%, transparent 55%),
      radial-gradient(circle at 85% 15%, var(--bg2) 0%, transparent 55%),
      radial-gradient(circle at 50% 110%, #fff 0%, var(--bg3) 60%, #f7f7ff 100%);
    overflow:hidden;
  }

  /* alive background blobs */
  .blob{
    position:fixed;
    width:260px; height:260px;
    border-radius:50%;
    filter: blur(26px);
    opacity:.22;
    z-index:0;
    animation: blobFloat 10.5s ease-in-out infinite;
    pointer-events:none;
  }
  @keyframes blobFloat{
    0%{ transform: translate(0,0) scale(1); }
    50%{ transform: translate(36px,-28px) scale(1.14); }
    100%{ transform: translate(0,0) scale(1); }
  }

  /* twinkling stars */
  .star{
    position:fixed;
    width:6px; height:6px;
    border-radius:50%;
    background:#fff;
    box-shadow:0 0 10px 3px rgba(255,255,255,.85);
    opacity:.25;
    animation: twinkle 2.6s infinite ease-in-out;
    pointer-events:none;
    z-index:0;
  }
  @keyframes twinkle{
    0%{opacity:.15; transform:scale(.8);}
    50%{opacity:1; transform:scale(1.55);}
    100%{opacity:.15; transform:scale(.8);}
  }

  #confetti{
    position:fixed;
    inset:0;
    pointer-events:none;
    z-index:1;
    display:none;
  }

  .arena{
    position:fixed;
    inset:0;
    pointer-events:none;
    z-index:10;
  }
  .runner{
    position:absolute;
    width:150px; height:150px;
    padding:18px;
    pointer-events:auto;
    cursor:pointer;
    filter: drop-shadow(0 18px 20px rgba(0,0,0,.12));
  }

  .fxLayer{
    position:fixed;
    inset:0;
    pointer-events:none;
    z-index:9;
  }

  .app{
    width:min(660px, 94vw);
    padding:16px;
    position:relative;
    z-index:2;
  }

  .card{
    background:var(--card);
    border:1px solid rgba(0,0,0,.06);
    border-radius:var(--radius);
    box-shadow: var(--shadow);
    padding:18px;
    backdrop-filter: blur(10px);
  }

  .top{
    display:flex;
    align-items:flex-start;
    justify-content:space-between;
    gap:12px;
    margin-bottom:12px;
  }

  .title{
    font-size:18px;
    font-weight:900;
    letter-spacing:.2px;
  }

  .sub{
    margin:6px 0 0;
    color:var(--muted);
    font-size:14px;
    line-height:1.45;
  }

  .badge{
    font-size:12px;
    padding:8px 10px;
    border-radius:999px;
    background:linear-gradient(90deg, rgba(255,179,199,.55), rgba(191,234,216,.55));
    border:1px solid rgba(0,0,0,.06);
    white-space:nowrap;
    user-select:none;
  }

  .screen{ display:none; }
  .screen.active{
    display:block;
    animation: screenIn .45s ease;
  }
  @keyframes screenIn{
    from{ opacity:0; transform: translateY(10px); }
    to{ opacity:1; transform: translateY(0); }
  }

  .nav{
    display:flex;
    gap:10px;
    margin-top:12px;
  }
  .btn{
    width:100%;
    padding:14px 14px;
    border:none;
    border-radius:16px;
    cursor:pointer;
    font-weight:820;
    font-size:15px;
    background:linear-gradient(90deg, rgba(255,179,199,.92), rgba(191,234,216,.92));
    box-shadow: 0 12px 30px rgba(0,0,0,.09);
    transition:.16s transform, .16s filter;
  }
  .btn:hover{ filter:saturate(1.1); }
  .btn:active{ transform: scale(.98); }
  .btn:disabled{ opacity:.55; cursor:not-allowed; }

  .btnGhost{
    width:auto;
    padding:12px 14px;
    border-radius:16px;
    border:1px solid rgba(0,0,0,.10);
    background:rgba(255,255,255,.60);
    box-shadow:none;
    font-weight:800;
    cursor:pointer;
    transition:.16s transform;
  }
  .btnGhost:active{ transform: scale(.98); }

  .stage{
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    text-align:center;
    padding-top:6px;
    gap:10px;
  }

  /* Gift box */
  .giftWrap{
    width:320px;
    height:295px;
    position:relative;
    user-select:none;
    -webkit-tap-highlight-color: transparent;
    cursor:pointer;
  }

  .giftBox{
    position:absolute;
    left:54px; right:54px;
    bottom:42px;
    height:160px;
    border-radius:26px;
    background:linear-gradient(180deg, #ffe7d8, #ffd7e5);
    box-shadow: 0 18px 40px rgba(0,0,0,.10);
    border:1px solid rgba(0,0,0,.05);
    overflow:hidden;
  }
  .giftStripeV{
    position:absolute; top:0; bottom:0;
    left:50%;
    width:40px;
    transform:translateX(-50%);
    background:linear-gradient(180deg, rgba(191,234,216,.98), rgba(216,199,255,.98));
  }
  .giftStripeH{
    position:absolute; left:0; right:0;
    top:60px;
    height:40px;
    background:linear-gradient(90deg, rgba(191,234,216,.98), rgba(216,199,255,.98));
  }

  .lid{
    position:absolute;
    left:38px; right:38px;
    top:86px;
    height:82px;
    border-radius:26px;
    background:linear-gradient(180deg, #ffe0ea, #ffd0de);
    box-shadow: 0 16px 34px rgba(0,0,0,.10);
    border:1px solid rgba(0,0,0,.05);
    transform-origin:center bottom;
    transition: transform .85s cubic-bezier(.2,.95,.2,1), top .85s cubic-bezier(.2,.95,.2,1);
    z-index:3;
  }

  .bow{
    position:absolute;
    left:50%;
    top:46px;
    width:112px;
    height:62px;
    transform:translateX(-50%);
    z-index:4;
    transition: transform .85s cubic-bezier(.2,.95,.2,1), top .85s cubic-bezier(.2,.95,.2,1);
  }
  .bow:before, .bow:after{
    content:"";
    position:absolute;
    width:54px;
    height:44px;
    top:10px;
    border-radius:20px 20px 20px 8px;
    background:linear-gradient(180deg, rgba(255,179,199,.98), rgba(255,210,166,.98));
    box-shadow: 0 10px 22px rgba(0,0,0,.08);
  }
  .bow:before{ left:0; transform:rotate(-10deg); }
  .bow:after{ right:0; transform:rotate(10deg) scaleX(-1); }
  .knot{
    position:absolute;
    left:50%;
    top:20px;
    width:24px; height:24px;
    transform:translateX(-50%);
    border-radius:8px;
    background:linear-gradient(180deg, rgba(255,210,166,.98), rgba(255,179,199,.98));
    box-shadow: 0 10px 20px rgba(0,0,0,.08);
  }

  .open .lid{ top:34px; transform: rotateX(78deg); }
  .open .bow{ top:16px; transform: translateX(-50%) rotate(-7deg); }

  .nudge{ animation: nudge 1.9s ease-in-out infinite; }
  @keyframes nudge{
    0%,100%{ transform: translateY(0); }
    50%{ transform: translateY(-4px); }
  }

  .kittyInBox{
    position:absolute;
    left:50%;
    top:132px;
    width:110px;
    height:110px;
    transform: translate(-50%, 36px) scale(.92);
    opacity:0;
    z-index:5;
    pointer-events:none;
    filter: drop-shadow(0 18px 20px rgba(0,0,0,.12));
  }
  @keyframes popOut{
    0%{ opacity:0; transform: translate(-50%, 36px) scale(.92); }
    45%{ opacity:1; transform: translate(-50%, -30px) scale(1.06); }
    75%{ opacity:1; transform: translate(-50%, -10px) scale(1); }
    100%{ opacity:1; transform: translate(-50%, -6px) scale(1); }
  }
  .kittyInBox.pop{ animation: popOut .75s cubic-bezier(.2,.95,.2,1) forwards; }

  .hint{
    font-size:13px;
    color:var(--muted);
    opacity:0;
    transform: translateY(-2px);
    transition: opacity .25s, transform .25s;
  }
  .hint.on{ opacity:1; transform: translateY(0); }

  /* Story Mode */
  .storyWrap{
    position:relative;
    overflow:hidden;
    border-radius:18px;
    border:1px solid rgba(0,0,0,.06);
    background:rgba(255,255,255,.65);
    box-shadow: 0 12px 30px rgba(0,0,0,.07);
    min-height:240px;
  }

  .storyTrack{
    display:flex;
    width:100%;
    transition: transform .55s cubic-bezier(.2,.95,.2,1);
    will-change: transform;
  }

  .slide{
    width:100%;
    flex:0 0 100%;
    padding:18px;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    text-align:center;
    gap:12px;
    position:relative;
  }

  /* ‚úÖ BIGGER icon so your images are visible */
  .iconSlot{
  width:136px;
  height:136px;
  border-radius:32px;
  background: rgba(255,255,255,.72);
  border:1px solid rgba(0,0,0,.08);
  display:flex;
  align-items:center;
  justify-content:center;
  overflow:hidden;
  box-shadow: 0 18px 40px rgba(0,0,0,.10);
}
  .iconSlot img{
  width:100%;
  height:100%;
  object-fit:contain;
  pointer-events:none;
  display:block;

  }

  /* ‚úÖ FIX: fallback emoji hidden by default so it won't show beside your image */
  .iconSlot .fallback{
    display:none;
    font-size:40px;
  }

  .bigLine{
    font-size:22px;
    font-weight:900;
    line-height:1.25;
  }

  .dots{
    display:flex;
    gap:7px;
    justify-content:center;
    margin-top:10px;
  }
  .dot{
    width:8px;
    height:8px;
    border-radius:999px;
    background: rgba(0,0,0,.18);
    transition: transform .2s, background .2s;
  }
  .dot.on{
    background: rgba(0,0,0,.55);
    transform: scale(1.25);
  }

  /* tiny fx particles (longer) */
  .fxParticle{
    position:absolute;
    font-size:18px;
    opacity:0;
    transform: translate(-50%,-50%) scale(.8);
    animation: popFade 1800ms ease forwards;
    filter: drop-shadow(0 10px 16px rgba(0,0,0,.10));
  }
  @keyframes popFade{
    0%{opacity:0; transform:translate(-50%,-50%) scale(.7) rotate(-6deg);}
    18%{opacity:1;}
    70%{opacity:1; transform:translate(-50%,-80%) scale(1.12) rotate(7deg);}
    100%{opacity:0; transform:translate(-50%,-105%) scale(1.18) rotate(10deg);}
  }
</style>
</head>

<body>
<div class="blob" style="left:-70px; top:40px; background:var(--pink)"></div>
<div class="blob" style="right:-80px; top:120px; background:var(--mint); animation-duration:12s"></div>
<div class="blob" style="left:40px; bottom:-100px; background:var(--lav); animation-duration:11s"></div>

<canvas id="confetti"></canvas>
<div class="arena" id="arena"></div>
<div class="fxLayer" id="fxLayer"></div>

<div class="app">
  <div class="card">
    <div class="top">
      <div>
        <div class="title" id="title">gift</div>
        <p class="sub" id="sub">tap the box</p>
      </div>
      <div class="badge" id="badge">1/3</div>
    </div>

    <!-- Screen 1: Gift -->
    <div class="screen active" id="s1">
      <div class="stage">
        <div class="giftWrap nudge" id="giftWrap">
          <div class="bow"><div class="knot"></div></div>
          <div class="lid"></div>

          <div class="giftBox">
            <div class="giftStripeV"></div>
            <div class="giftStripeH"></div>
          </div>

          <img class="kittyInBox" id="kittyInBox" src="kitten.png" alt="kitten" />
        </div>

        <div class="hint" id="hint">catch kitten (tap it / tap anywhere / or press catch)</div>

        <div class="nav">
          <button class="btnGhost" id="restartBtn" style="flex:1">restart</button>
          <button class="btnGhost" id="catchBtn" style="flex:1">catch</button>
          <button class="btn" id="openBtn" style="flex:1.2">open</button>
        </div>
      </div>
    </div>

    <!-- Screen 2: Slides -->
    <div class="screen" id="s2">
      <div class="storyWrap">
        <div class="storyTrack" id="track">

          <!-- Slide 1 -->
          <div class="slide" data-key="sparkles">
            <div class="iconSlot">
              <img src="sparkles.png" alt=""
                onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
              <div class="fallback">‚ú®</div>
            </div>
            <div class="bigLine">You Day!!!!</div>
          </div>

          <!-- Slide 2 -->
          <div class="slide" data-key="paw-prints">
            <div class="iconSlot">
              <img src="paw-prints.png" alt=""
                onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
              <div class="fallback">üêæ</div>
            </div>
            <div class="bigLine">Oldie, you‚Äôre 21. Don‚Äôt worry I‚Äôll always be here before you üòº</div>
          </div>

          <!-- Slide 3 -->
          <div class="slide" data-key="ribbon-pop">
            <div class="iconSlot">
              <img src="ribbon-pop.png" alt=""
                onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
              <div class="fallback">üéÄ</div>
            </div>
            <div class="bigLine">You act tough, but you actually care about everything.</div>
          </div>

          <!-- Slide 4 -->
          <div class="slide" data-key="note-slide">
            <div class="iconSlot">
              <img src="note-slide.png" alt=""
                onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
              <div class="fallback">üìù</div>
            </div>
            <div class="bigLine">You bring the energy wherever you go.</div>
          </div>

          <!-- Slide 5 -->
          <div class="slide" data-key="crown">
            <div class="iconSlot">
              <img src="crown.png" alt=""
                onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
              <div class="fallback">üëë</div>
            </div>
            <div class="bigLine">I respect you more than I say.</div>
          </div>

        </div>
      </div>

      <div class="dots" id="dots"></div>

      <div class="nav">
        <button class="btnGhost" id="backToGift">back</button>
        <button class="btnGhost" id="prevBtn">prev</button>
        <button class="btn" id="nextBtn">next</button>
      </div>
    </div>

    <!-- Screen 3: Final -->
    <div class="screen" id="s3">
      <div class="stage">
        <div style="font-size:32px; font-weight:950; margin:4px 0 10px;">
          Happy Birth <span style="display:inline-block; padding:4px 12px; border-radius:999px; background:linear-gradient(90deg, rgba(255,179,199,.65), rgba(216,199,255,.65)); border:1px solid rgba(0,0,0,.06);">Fatoom</span>
        </div>
        <p class="sub" style="font-size:16px; margin:0; max-width:44ch;">
          May Allah put barakah in your time and ease what comes next.
        </p>
        <div class="nav">
          <button class="btnGhost" id="backToSlides">back</button>
          <button class="btn" id="boomBtn">boom again</button>
        </div>
      </div>
    </div>

  </div>
</div>

<script>
  // ===== Stars =====
  (function makeStars(){
    const count = 18;
    for(let i=0;i<count;i++){
      const s=document.createElement("div");
      s.className="star";
      s.style.left=(Math.random()*100)+"vw";
      s.style.top=(Math.random()*100)+"vh";
      s.style.animationDelay=(Math.random()*2.6)+"s";
      const sz = (4 + Math.random()*4);
      s.style.width = sz + "px";
      s.style.height = sz + "px";
      document.body.appendChild(s);
    }
  })();

  function burstStars(){
    for(let i=0;i<10;i++){
      const s=document.createElement("div");
      s.className="star";
      s.style.left=(36+Math.random()*28)+"vw";
      s.style.top=(30+Math.random()*18)+"vh";
      s.style.animationDuration="1.3s";
      s.style.width="7px"; s.style.height="7px";
      document.body.appendChild(s);
      setTimeout(()=>s.remove(),1800);
    }
  }

  // ===== Screens =====
  const screens = [document.getElementById("s1"), document.getElementById("s2"), document.getElementById("s3")];
  const titleEl = document.getElementById("title");
  const subEl = document.getElementById("sub");
  const badgeEl = document.getElementById("badge");

  function setScreen(i){
    screens.forEach((s, idx)=> s.classList.toggle("active", idx===i));
    badgeEl.textContent = (i+1)+"/3";
    if(i===0){ titleEl.textContent="GiftüéÄ"; subEl.textContent="tap the box"; }
    if(i===1){ titleEl.textContent="FOR YOUU"; subEl.textContent="tap next"; }
    if(i===2){ titleEl.textContent="Booom"; subEl.textContent="happy 21st"; }
  }

  // ===== Gift + kitten =====
  const giftWrap = document.getElementById("giftWrap");
  const openBtn = document.getElementById("openBtn");
  const catchBtn = document.getElementById("catchBtn");
  const restartBtn = document.getElementById("restartBtn");
  const kittyInBox = document.getElementById("kittyInBox");
  const hint = document.getElementById("hint");
  const arena = document.getElementById("arena");

  let opened = false;
  let runner = null;
  let raf = null;
  let tapAnyHandler = null;

  function rand(min,max){ return Math.random()*(max-min)+min; }

  function stopRunner(){
    if(raf) cancelAnimationFrame(raf);
    raf = null;
    if(runner){ runner.remove(); runner=null; }
    if(tapAnyHandler){
      document.removeEventListener("pointerdown", tapAnyHandler);
      tapAnyHandler = null;
    }
  }

  // ===== Slides =====
  const track = document.getElementById("track");
  const slides = Array.from(document.querySelectorAll(".slide"));
  const dotsWrap = document.getElementById("dots");
  const prevBtn = document.getElementById("prevBtn");
  const nextBtn = document.getElementById("nextBtn");
  const fxLayer = document.getElementById("fxLayer");
  const storyWrap = document.querySelector(".storyWrap");

  let currentSlide = 0;

  function buildDots(){
    dotsWrap.innerHTML = "";
    slides.forEach((_, i)=>{
      const d = document.createElement("div");
      d.className = "dot" + (i===0 ? " on" : "");
      dotsWrap.appendChild(d);
    });
  }
  buildDots();

  function setSlide(i, silent=false){
    currentSlide = Math.max(0, Math.min(slides.length-1, i));
    track.style.transform = `translateX(${-currentSlide * 100}%)`;
    Array.from(dotsWrap.children).forEach((d, idx)=> d.classList.toggle("on", idx===currentSlide));
    prevBtn.disabled = currentSlide === 0;
    nextBtn.textContent = (currentSlide === slides.length-1) ? "finish" : "next";
    if(!silent) playSlideFX(currentSlide);
  }

  function resetSequence(){
    stopRunner();
    opened = false;
    openBtn.disabled = false;
    openBtn.textContent = "open";
    giftWrap.classList.remove("open");
    giftWrap.classList.add("nudge");
    hint.classList.remove("on");
    kittyInBox.classList.remove("pop");
    kittyInBox.style.display = "block";
    kittyInBox.style.opacity = "0";
    setSlide(0, true);
    setScreen(0);
  }

  function catchKitten(){
    stopRunner();
    setScreen(1);
    playSlideFX(currentSlide);
  }

  function startRunner(){
    runner = document.createElement("img");
    runner.src = "kitten.png";
    runner.alt = "kitten";
    runner.className = "runner";
    arena.appendChild(runner);

    let x = window.innerWidth*0.52;
    let y = window.innerHeight*0.46;
    let vx = rand(2.0, 3.0) * (Math.random()<0.5 ? -1 : 1);
    let vy = rand(1.6, 2.4) * (Math.random()<0.5 ? -1 : 1);

    let lastPause = performance.now();
    let pausedUntil = 0;

    function step(now){
      if(now - lastPause > 900){
        pausedUntil = now + 220;
        lastPause = now;
      }
      const paused = now < pausedUntil;

      if(!paused){ x += vx; y += vy; }

      const size = 150, pad = 8;
      if(x < pad){ x = pad; vx *= -1; }
      if(x > window.innerWidth - size - pad){ x = window.innerWidth - size - pad; vx *= -1; }
      if(y < pad){ y = pad; vy *= -1; }
      if(y > window.innerHeight - size - pad){ y = window.innerHeight - size - pad; vy *= -1; }

      const wiggle = Math.sin(now/120) * (paused ? 1.1 : 2.2);
      runner.style.transform = `translate(${x}px, ${y}px) rotate(${wiggle}deg) scaleX(${vx>0 ? 1 : -1})`;

      raf = requestAnimationFrame(step);
    }
    raf = requestAnimationFrame(step);

    runner.addEventListener("click", catchKitten);

    tapAnyHandler = () => { if(runner) catchKitten(); };
    document.addEventListener("pointerdown", tapAnyHandler);
  }

  function openGift(){
    if(opened) return;
    opened = true;
    giftWrap.classList.add("open");
    giftWrap.classList.remove("nudge");
    openBtn.disabled = true;
    openBtn.textContent = "opened";
    kittyInBox.classList.add("pop");
    kittyInBox.style.opacity = "1";

    setTimeout(()=>{
      hint.classList.add("on");
      kittyInBox.style.display = "none";
      startRunner();
    }, 850);
  }

  giftWrap.addEventListener("click", openGift);
  openBtn.addEventListener("click", (e)=>{ e.stopPropagation(); openGift(); });
  catchBtn.addEventListener("click", ()=>{ if(opened) catchKitten(); });
  restartBtn.addEventListener("click", resetSequence);

  prevBtn.addEventListener("click", ()=> setSlide(currentSlide - 1));
  nextBtn.addEventListener("click", ()=>{
    if(currentSlide === slides.length - 1){
      setScreen(2);
      startConfetti(2600);
      return;
    }
    setSlide(currentSlide + 1);
  });

  document.getElementById("backToGift").addEventListener("click", resetSequence);
  document.getElementById("backToSlides").addEventListener("click", ()=> setScreen(1));

  // swipe on mobile
  let sx=0, sy=0;
  storyWrap.addEventListener("touchstart", (e)=>{
    sx = e.touches[0].clientX;
    sy = e.touches[0].clientY;
  }, {passive:true});
  storyWrap.addEventListener("touchend", (e)=>{
    const ex = e.changedTouches[0].clientX;
    const ey = e.changedTouches[0].clientY;
    const dx = ex - sx;
    const dy = ey - sy;
    if(Math.abs(dx) > 45 && Math.abs(dy) < 60){
      if(dx < 0) nextBtn.click();
      else prevBtn.click();
    }
  });

  // ===== Slide FX =====
  function spawnParticles(symbols, count, cx, cy){
    for(let i=0;i<count;i++){
      const p = document.createElement("div");
      p.className = "fxParticle";
      p.textContent = symbols[Math.floor(Math.random()*symbols.length)];
      const dx = (Math.random()*180 - 90);
      const dy = (Math.random()*120 - 60);
      p.style.left = (cx + dx) + "px";
      p.style.top  = (cy + dy) + "px";
      p.style.animationDelay = (Math.random()*120) + "ms";
      fxLayer.appendChild(p);
      setTimeout(()=>p.remove(), 1900);
    }
  }

  function slideCenter(){
    const r = storyWrap.getBoundingClientRect();
    return { cx: r.left + r.width/2, cy: r.top + r.height/2 };
  }

  function playSlideFX(i){
    const key = slides[i].dataset.key;
    const {cx, cy} = slideCenter();

    if(key === "sparkles"){
      spawnParticles(["‚ú®","‚≠ê","üí´"], 16, cx, cy);
      burstStars();
    }
    if(key === "paw-prints"){
      spawnParticles(["üêæ","‚ú®","üòº"], 14, cx, cy);
    }
    if(key === "ribbon-pop"){
      spawnParticles(["üéÄ","üíó","ü´ß"], 14, cx, cy);
    }
    if(key === "note-slide"){
  spawnParticles(["üí•","‚ú®","üí´"], 14, cx, cy);
    }
    if(key === "crown"){
      spawnParticles(["üëë","‚ú®","‚≠ê"], 16, cx, cy);
    }
  }

  // ===== Confetti =====
  const canvas = document.getElementById("confetti");
  const ctx = canvas.getContext("2d");
  let W,H,pieces=[],running=false;

  function resize(){
    W = canvas.width = window.innerWidth;
    H = canvas.height = window.innerHeight;
  }
  window.addEventListener("resize", resize);
  resize();

  function makeConfetti(n=260){
    const colors = ["#ffb3c7","#ffd2a6","#bfead8","#d8c7ff","#ffffff"];
    pieces = Array.from({length:n}).map(()=>({
      x: Math.random()*W,
      y: Math.random()*-H,
      s: 4 + Math.random()*5,
      vy: 2.8 + Math.random()*4.4,
      vx: -2.6 + Math.random()*5.2,
      r: Math.random()*Math.PI,
      vr: -0.16 + Math.random()*0.32,
      c: colors[Math.floor(Math.random()*colors.length)]
    }));
  }

  function draw(){
    if(!running) return;
    ctx.clearRect(0,0,W,H);
    for(const p of pieces){
      p.x += p.vx;
      p.y += p.vy;
      p.r += p.vr;

      if(p.y > H + 20){ p.y = -60; p.x = Math.random()*W; }
      if(p.x < -20) p.x = W+20;
      if(p.x > W+20) p.x = -20;

      ctx.save();
      ctx.translate(p.x,p.y);
      ctx.rotate(p.r);
      ctx.fillStyle = p.c;
      ctx.fillRect(-p.s/2, -p.s/2, p.s, p.s);
      ctx.restore();
    }
    requestAnimationFrame(draw);
  }

  function startConfetti(ms=1400){
    canvas.style.display="block";
    running=true;
    makeConfetti(320);
    draw();
    setTimeout(()=>{
      running=false;
      ctx.clearRect(0,0,W,H);
      canvas.style.display="none";
    }, ms);
  }

  document.getElementById("boomBtn").addEventListener("click", ()=> startConfetti(2400));

  // ===== Boot =====
  setScreen(0);
  resetSequence();
</script>
</body>
</html>
